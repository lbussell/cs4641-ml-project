<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>CS4641 Project Proposal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css" type="text/css">
</head>

<body>
    <h1>Predicting the Next Pitch</h1>

    <strong>CS 4641 Spring 2021 Group 35 Project Proposal</strong>

    <p>Ali Ardestani, Logan Bussell, Jim James, Sreekar Madabushi, John Maginnes</p>

    <h4>Video</h4>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/3iw3mmttbJI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <h2>Introduction</h2>
    <p>In baseball, there are a few distinct types of pitches that a pitcher can make, and it is tough to tell which one
        they will make at any given time. However, a pitcher isn’t a random number generator - they likely make certain
        pitches with higher probability than others, and change up their strategy depending on the state of the game and
        the opposing batter’s skill. Knowing what pitch that an opposing pitcher is going to make next can help to
        improve a batter’s accuracy.</p>

    <p>The inspiration for this project came from discussion with a manager on Georgia Tech’s baseball team, who
        envisioned a system that could predict their opponent’s pitches without cheating.</p>

    <h2>Problem Definition</h2>
    <p>Hitting a baseball is very difficult. A great batter can hit the ball only about 30% of the time. We would like
        to increase the chances of a Major League Baseball batter hitting the ball by predicting for them ahead of time
        what kind of pitch (fast ball, curve ball, etc) will be thrown next. This will be based on several factors: for
        example, if all bases are loaded and the incoming batter has very strong stats, then the pitcher is likely to
        walk the batter. As such, we will include the stats of the batter (average hit rate, percent of home runs,
        etc.), the number of runs, the state of the bases, and the pitcher’s previous throws as features in our model.
    </p>

    <h2>Methods</h2>
    <p>Train a machine learning model based on a pitcher’s prior games, taking in the game’s state, the pitcher’s
        metrics, and each batter’s metrics. Then in the middle of a game, use this model to try and predict the
        pitcher’s next move so that the batter can anticipate the pitch and has a better chance at hitting the ball.
        Some possible machine learning techniques for this task include using random forest, as seen in some previous
        research in this area. On the deep learning side, given that we’re dealing with data that changes over time,
        using a recurrent neural network such as a Long Short Term Memory may also be effective.</p>

    <h2>Potential Results</h2>
    <p>We would like to be able to predict the pitcher’s next move with a reliability greater than the naive guess.
        Ideally, this would be applicable to a real baseball game, allowing a batter to have a higher likelihood of
        hitting the ball. This can be tested on previous (and future) major league baseball games, by picking a subset
        of them that will not be used in training our model and comparing how our predictions are in comparison to the
        real pitches in the game. While it is unlikely that our predictions will be extremely accurate, we would like to
        predict at a statistically significant rate higher than a naive guess, as this would constitute an improvement.
    </p>

    <h2>Discussion</h2>
    <p>At this stage, there are still some components about the implementation that aren’t yet defined, such as which
        specific features to use, and whether to predict simply the type of pitch or also the speed. Additionally, it is
        hard to determine how viable the idea is. For example, some studies show a significant improvement compared to
        the naive guess, while others show none.</p>

    <h2>References and Similar Studies</h2>
    <ul>
        <li><a href="https://medium.com/@matt42kirby/predicting-baseball-pitches-33f906cbbdee">Predicting pitches for a
                single pitcher at 15% better than naive guess</a></li>
        <li><a
                href="https://medium.com/@alexwbell/predicting-the-next-baseball-pitch-utilizing-machine-learning-to-gain-an-advantage-cef35bbd6e26">Predicting
                the next baseball pitch</a></li>
        <li><a href="https://cs230.stanford.edu/projects_spring_2018/reports/8290890.pdf">Predicting Next Baseball Pitch
                Type with RNN</a></li>
        <li><a href="https://dash.harvard.edu/bitstream/handle/1/37364634/PLUNKETT-SENIORTHESIS-2019.pdf?sequence=1">Pitch
                Type Prediction in Major League Baseball</a></li>
        <li><a
                href="https://www.researchgate.net/publication/326972628_Applying_machine_learning_techniques_to_baseball_pitch_prediction">Applying
                Machine Learning Techniques to Baseball Pitch Prediction</a></li>
        <li><a href="https://fisher.wharton.upenn.edu/wp-content/uploads/2020/09/Thesis_Andrew-Cui.pdf">Forecasting
                Outcomes of Major League Baseball Games Using Machine Learning</a></li>
    </ul>
    
    <h2>Data Collection</h2>
    <p>For the data collection portion, our team was able to make use of a library known as pybaseball. This python package scrapes from Baseball Reference, Baseball Savant, and 
        FanGraphs to build out an API and allow developers to more easily access current and historical baseball data.  After experimenting a bit with the package, we decided 
        to focus on 6 pitchers for the purpose of our research. We pulled all of their provided pitching data down into .csv files.
        For the purposes of this midpoint stage, we only tested our methods on Gerrit Cole’s career pitching data. </p>
    <h2>Data Cleaning</h2>
    <p>The next step was to clean the data we retrieved from the package down to only statistics we saw as relevant for our model. This left us with 19 statistics to analyze the data on, 
       which can be seen in our jupyter notebook file called ‘data_cleaning.’ Furthermore, we shifted down particular columns so that they aligned with the next at bat. This made it easy to quickly analyze 
       what event happened previously leading up to the current pitch. Lastly, we changed the categorical data to one-hot encoding, so that it could more easily be used with our model.</p>
    <img src="../assets/cleaned_data.png"/>

    <h2>Methods</h2>
    <p>We decided to use a neural network in PyTourch with an ReLU activation function, 5 layers, and a softmax activation function at the end of the network. For training we used 10 epochs and an Adam optimizer.
       We chose the adam optimizer instead of the SGD to avoid local min of 33% accuracy. For the train-validation cycle, 80% of the data was used to train the network,
       while the other 20% was used for validation to ensure no overfitting.</p>
    <h2>Results and Discussion</h2>
    <p>In total, we obtained an accuracy of 54%. This is barely better than the naive guess, considering that 51% of our data was a fastball, so we would only be guessing 3% worse if we guessed fastball everytime.
    We will need to look for a better way of determining accuracy.</p>

    
</body>

</html>
